# configuration for "develop" branch
# build in Release mode
-
  environment:
    packageVersion: 1.0.0-dev

  version: '{branch}-%packageVersion%-{build}'
  image: Visual Studio 2017

  install:
    - cmd: appveyor DownloadFile https://dist.nuget.org/win-x86-commandline/latest/nuget.exe

  cache:
    - packages -> **\packages.config

  pull_requests:
    do_not_increment_build_number: false

  skip_branch_with_pr: false

  before_build:
    - cmd: nuget restore

  build:
    verbosity: minimal

  after_test:
    ps: Get-ChildItem -Path Build\Lib\$(configuration)\netstandard1.1 | Where-Object {$_.Extension -match '.dll|.pdb|.xml'} | Rename-Item -NewName {'Trakt.NET.$(packageVersion)-$(build)' + $_.Extension}

  branches:
    only:
      - develop

  configuration: Release

  artifacts:
    - path: Build\Lib\$(configuration)\netstandard1.1\Trakt.NET.*.dll
      name: Assembly
    - path: Build\Lib\$(configuration)\netstandard1.1\Trakt.NET.*.pdb
      name: AssemblyPDB
    - path: Build\Lib\$(configuration)\netstandard1.1\Trakt.NET.*.xml
      name: DocumentationXML

# "fall back" configuration for all other branches
# no "branches" section defined
# do not deploy at all
-
  version: '{branch}-{build}'
  image: Visual Studio 2017

  install:
    - cmd: appveyor DownloadFile https://dist.nuget.org/win-x86-commandline/latest/nuget.exe

  cache:
    - packages -> **\packages.config

  pull_requests:
    do_not_increment_build_number: false

  skip_branch_with_pr: false

  before_build:
    - cmd: nuget restore

  build:
    verbosity: minimal

  configuration: Release

  artifacts:
    - path: Build\Lib\$(configuration)\netstandard1.1\Trakt.NET.dll
      name: Assembly
    - path: Build\Lib\$(configuration)\netstandard1.1\Trakt.NET.pdb
      name: AssemblyPDB
    - path: Build\Lib\$(configuration)\netstandard1.1\Trakt.NET.xml
      name: DocumentationXML
